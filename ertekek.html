<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Values Ranking App</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .hidden { display: none; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; }
    .card { border: 1px solid #ccc; padding: 10px; cursor: pointer; user-select: none; }
    .card.selected { background: #def; border-color: #39f; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 1rem; }
    .pool, .dropzone { border: 2px dashed #ccc; min-height: 100px; padding: 10px; margin-top: 20px; }
    .pool .card { margin: 5px; display: inline-block; }
    .dropzone { display: inline-block; width: 48%; vertical-align: top; }
    .dropzone.over { border-color: #39f; }
    .slots { display: flex; gap: 10px; margin-top: 20px; }
    .slot { border: 2px dashed #ccc; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    canvas { margin-top: 20px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <div id="step1">
    <h2>Step 1 – Select 10–15 Values</h2>
    <div class="grid" id="valuesGrid"></div>
    <button id="toStep2" disabled>Next</button>
  </div>

  <div id="step2" class="hidden">
    <h2>Step 2 – Sort Into Top 1–5 and Top 6–10</h2>
    <div class="pool" id="selectedPool"></div>
    <div>
      <div class="dropzone" id="zone1" data-limit="5">TOP 1–5</div>
      <div class="dropzone" id="zone2" data-limit="5">TOP 6–10</div>
    </div>
    <button id="toStep3" disabled>Next</button>
  </div>

  <div id="step3" class="hidden">
    <h2>Step 3 – Rank Your Top 5</h2>
    <div class="slots" id="rankSlots"></div>
    <div class="pool" id="top5Pool"></div>
    <button id="finalizeBtn" disabled>Finalize</button>
  </div>

  <canvas id="resultCanvas" width="600" height="400" class="hidden"></canvas>

  <script>
    const values = [
      { title: 'HONESTY', def: 'Being truthful and transparent.' },
      { title: 'CURIOSITY', def: 'Desire to learn and explore.' },
      { title: 'COMPASSION', def: 'Empathy and kindness to others.' },
      { title: 'COURAGE', def: 'Facing fears and challenges.' },
      { title: 'INTEGRITY', def: 'Acting according to moral principles.' },
      { title: 'GROWTH', def: 'Continuous self-improvement.' },
      { title: 'FREEDOM', def: 'Autonomy and independence.' },
      { title: 'GRATITUDE', def: 'Appreciation for what one has.' },
      { title: 'RESILIENCE', def: 'Bouncing back from adversity.' },
      { title: 'JOY', def: 'Finding pleasure and happiness.' },
      { title: 'BALANCE', def: 'Maintaining equilibrium in life.' },
      { title: 'SERVICE', def: 'Helping and contributing.' },
      { title: 'AUTHENTICITY', def: 'Being true to oneself.' },
      { title: 'RESPECT', def: 'Valuing others and boundaries.' },
      { title: 'LEADERSHIP', def: 'Inspiring and guiding.' }
    ];

    // Step1
    const grid = document.getElementById('valuesGrid');
    const toStep2 = document.getElementById('toStep2');
    values.forEach((v,i) => {
      const c = document.createElement('div');
      c.className = 'card'; c.draggable = false;
      c.innerHTML = `<strong>${v.title}</strong><p>${v.def}</p>`;
      c.dataset.index = i;
      c.addEventListener('click', () => {
        c.classList.toggle('selected');
        const count = document.querySelectorAll('.card.selected').length;
        toStep2.disabled = !(count >= 10 && count <= 15);
      });
      grid.appendChild(c);
    });

    toStep2.addEventListener('click', () => {
      document.getElementById('step1').classList.add('hidden');
      initStep2();
      document.getElementById('step2').classList.remove('hidden');
    });

    // Step2
    function initStep2() {
      const pool = document.getElementById('selectedPool');
      document.querySelectorAll('.card.selected').forEach(c => {
        c.classList.remove('selected');
        c.draggable = true;
        pool.appendChild(c);
        c.addEventListener('dragstart', dragStart);
      });
      ['zone1','zone2'].forEach(id => {
        const zone = document.getElementById(id);
        zone.addEventListener('dragover', dragOver);
        zone.addEventListener('dragleave', dragLeave);
        zone.addEventListener('drop', drop);
      });
    }

    let dragged;
    function dragStart(e) { dragged = e.target; }
    function dragOver(e) { e.preventDefault(); e.currentTarget.classList.add('over'); }
    function dragLeave(e) { e.currentTarget.classList.remove('over'); }
    function drop(e) {
      e.preventDefault(); e.currentTarget.classList.remove('over');
      const limit = +e.currentTarget.dataset.limit;
      if (e.currentTarget.children.length >= limit) {
        alert('Limit reached'); return;
      }
      e.currentTarget.appendChild(dragged);
      checkZones();
    }

    function checkZones() {
      const z1 = document.getElementById('zone1').children.length;
      const z2 = document.getElementById('zone2').children.length;
      document.getElementById('toStep3').disabled = !(z1===5 && z2===5);
    }

    document.getElementById('toStep3').addEventListener('click', () => {
      document.getElementById('step2').classList.add('hidden');
      initStep3();
      document.getElementById('step3').classList.remove('hidden');
    });

    // Step3
    function initStep3() {
      const slots = document.getElementById('rankSlots');
      const pool = document.getElementById('top5Pool');
      document.getElementById('zone1').childNodes.forEach(c => {
        c.draggable = true;
        pool.appendChild(c);
        c.addEventListener('dragstart', dragStart2);
      });
      for (let i=1; i<=5; i++) {
        const s = document.createElement('div');
        s.className = 'slot'; s.dataset.slot = i;
        s.textContent = i;
        s.addEventListener('dragover', dragOver);
        s.addEventListener('dragleave', dragLeave);
        s.addEventListener('drop', drop2);
        slots.appendChild(s);
      }
    }

    let dragged2;
    function dragStart2(e) { dragged2 = e.target; }
    function drop2(e) {
      e.preventDefault(); e.currentTarget.classList.remove('over');
      if (e.currentTarget.children.length) return;
      e.currentTarget.appendChild(dragged2);
      checkSlots();
    }
    function checkSlots() {
      const filled = [...document.querySelectorAll('.slot')].filter(s=>s.children.length).length;
      document.getElementById('finalizeBtn').disabled = (filled !== 5);
    }

    document.getElementById('finalizeBtn').addEventListener('click', () => {
      const canvas = document.getElementById('resultCanvas');
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,canvas.width, canvas.height);
      ctx.fillStyle = '#000'; ctx.font = '20px sans-serif';
      ctx.fillText('My Top Five Values', 20, 40);
      ctx.font = '16px sans-serif';
      document.querySelectorAll('.slot').forEach((s,i) => {
        const card = s.children[0];
        const title = card.querySelector('strong').textContent;
        ctx.fillText(`${i+1}. ${title}`, 20, 80 + i*30);
      });
      canvas.classList.remove('hidden');
    });
  </script>
</body>
</html>
